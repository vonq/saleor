<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Data Quality Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" crossorigin="anonymous"></script>
</head>
<body>
<style>
    .level-danger, .level-info, .level-warning, .level-ok {
        border: solid;
        border-width: 0.2rem 0.1rem 0.1rem 1rem;
        margin-bottom: 0.3rem;
    }

    .level-danger {
        border-color: red;
    }

    .level-info {
        border-color: blue;
    }

    .level-warning {
        border-color: orange;
    }

    .level-ok {
        border-color: green;
    }

    .accordion-button, .accordion-header, .accordion-collapse {
        background-color: transparent !important;
    }
</style>
<div class="container" id="data-quality-app">
    <div class="row mt-2 mb-3">
        <div class="col-7">
             <h1>Data Quality Dashboard</h1>
        </div>
        <div class="col-5">
            <div style="font-size: xx-small; float:right" class="">
                On two occasions I have been asked, 'Pray, Mr. Babbage, if you put into the machine wrong figures, will the right answers come out?'
                I am not able rightly to apprehend the kind of confusion of ideas that could provoke such a question. &mdash; Charles Babbage
            </div>
        </div>
    </div>
     <div class="row">
            <div class="col">
                <li class="card">
                    <div class="card-header"><h3>[[ locations.length ]] Locations</h3></div>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item">
                            <strong>Approved: </strong> <span v-for="k, v in freqDist(locations, 'approved')">[[v]]:[[k]] </span>
                        </li>
                    </ul>
            </div>
            <div class="col">
                <div class="card">
                    <div class="card-header">
                        <div v-if="products == null">
                            <div class="spinner-border" role="status"><span class="visually-hidden">Loading...</span></div>
                        </div>
                        <div v-else><h3>[[ products.length ]] Products</h3></div>
                    </div>
                    <div v-if="products !== null">
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item"><strong>Status: </strong> <span v-for="k, v in freqDist(products, 'status')">[[v]]:[[k]] </span></li>
                            <li class="list-group-item"><strong>is Active: </strong> <span v-for="k, v in freqDist(products, 'is_active')">[[v]]:[[k]] </span></li>
                            <li class="list-group-item"><strong>is Recommended: </strong> <span v-for="k, v in freqDist(products, 'is_recommended')">[[v]]:[[k]] </span></li>
                        </ul>
                    </div>
                </div>
            </div>
         </div>
         <div class="row">
            <div class="col">
                <h2>Checks</h2>
                <strong>Notes:</strong>
                <ul>
                    <li>A Product is 'Active' if it has <code>is_active=True</code></li>
                    <li>A 'Board' is a Product for which <code>saleforce_product_category='Generic Product'</code></li>
                </ul>
                <form class="form-check-inline">
                    <input type="checkbox" class="form-check-input" v-model="showPassingChecks" id="showPassingChecksCB">
                    <label class="form-check-label" for="showPassingChecksCB"> Show [[ checksPassingCount ]] passing checks</label>
                </form>
                <div v-for="check, i in checks">
                    <div v-if="!check.pass || showPassingChecks" class="accordion" id="accordionExample">
                      <div class="accordion-item" v-bind:class="classesFor(check)">
                        <h2 class="accordion-header" id="checkheading">
                          <button class="accordion-button" type="button" data-bs-toggle="collapse" :data-bs-target="'#collapse'+i" aria-expanded="true" :aria-controls="'collapse'+i">
                            [[ check.label ]] ([[check.values !== null ? check.values.length : '*']])
                          </button>
                        </h2>
                        <div :id="'collapse'+i" class="accordion-collapse collapse accordion-flush" aria-labelledby="headingOne" data-bs-parent="#accordionExample">
                            <div class="accordion-body" v-if="check.type == 'simple'">
                                <ul>
                                    <span v-for="value in check.values"><a :href="value.admin_url">[[ value.label ]]</a>, </span>
                                </ul>
                            </div>

                            <div class="accordion-body" v-if="check.type == 'structured'">
                                <ul>
                                    <li v-for="value in check.values"><a :href="value.admin_url">[[ value.label ]]</a>
                                        <span v-if="value.values">[[ value.values.join(', ') ]]</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                      </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="/static/vue.min.js"></script>
<script src="/static/d3.v5.min.js"></script>
<script src="/static/data_quality_app.js"></script>
</body>
</html>
